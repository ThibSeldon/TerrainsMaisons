{% extends 'base_all.html.twig' %}

{% block description %}
    <!-- Meta Description -->
    <meta name="description" content="Terrains dipsonibles pour le lotissement {{ allotment.name }} situé à {{ allotment.city }} - Parcourez la liste des Maisons disponibles pour ce programme">
{% endblock %}

{% block title %}
  Terrain {{ allotment.name}}  - {{ allotment.city }}
{% endblock %}

{% block body %}

    <link rel="stylesheet" href="css/tab.css">
    <link rel="stylesheet" href="css/imageModal.css">

<div class="row justify-content-center">
    <div class="col-12 col-xl-6 d-flex align-items-stretch">
      <div class="jumbotron jumbotron-fluid">
          <div class="container">
            <h1 class="">{{ allotment.name }}</h1>
            <p class="lead">Pour votre future Maison : Découvrez le programme</p>
            <hr class="my-4">
            <p>Retrouvez toutes les informations sur le lotissement et parcourrez les terrains disponibles.</p>
            <p>Lorsque vous choisissez un terrain, cliquez dessus pour découvrir les Maisons compatibles et réalisez votre
                projet.</p>
        </div>
    </div>
    </div>

    <!--   Tab Menu -->
        <div class="col-12 col-xl-6">
            <ul class="nav nav-tabs flex-sm-row rounded-nav" id="allotmentTab" role="tablist">
                <li class="nav-item flex-sm-fill">
                    <a href="#plan" class="nav-link text-uppercase font-weight-bold" id="plan-tab" data-toggle="tab" role="tab">Plans</a>
                </li>
                <li class="nav-item flex-sm-fill">
                    <a href="#doc" class="nav-link text-uppercase font-weight-bold" id="doc-tab" data-toggle="tab" role="tab">Documents</a>
                </li>
            </ul>

            <div class="tab-content" id="myTabContent">

                <div class="tab-pane fade px-4 py-5 show active" id="plan" role="tabpanel" aria-labelledby="plan-tab">

                        <div class="row">
                            <div class="col">
                                {% if allotment.allotmentPlanFile %}<img id="myImg" src="{{ asset('uploads/pictures/'~ allotment.allotmentPlanFile ) }}" class="img-fluid"
                                     alt="{{ allotment.name }}">
                                {% else %}
                                <img id="myImg" src="/images/LandCouvWeb.jpg" class="img-fluid"
                                     alt="Projet Terrains Maisons . com ">
                                {% endif %}
                            </div>
                        </div>

                </div>

                <div class="tab-pane fade px-4 py-5" id="doc" role="tabpanel" aria-labelledby="doc-tab">
                    Liste documents
                    <table class="table">
                        <tbody>
                        <tr>
                            <th> PLU</th>
                            <td>{% if allotment.localUrbanPlanFile %} <a href="{{ asset('uploads/plans/'~allotment.localUrbanPlanFile) }}" target="_blank" >Télécharger</a>{% endif %}</td>
                        </tr>
                        <tr>
                            <th> Réglement du Lotissement</th>
                            <td>{% if allotment.regulationFile %}<a href="{{ asset('uploads/plans/'~allotment.regulationFile) }}"  target="_blank"> Télécharger</a>{% endif %}</td>
                        </tr>
                        </tbody>
                    </table>
                </div>

            </div>
        </div>
    </div>


    <!-- The Modal -->
    <div id="myModal" class="modal">

        <!-- The Close Button -->
        <span class="close">&times;</span>

        <!-- Modal Content (The Image) -->
        <img class="modal-content" id="img01">

        <!-- Modal Caption (Image Text) -->
        <div id="caption"></div>
    </div>


<div class="row justify-content-center">
    <h2>Terrains disponibles </h2>
</div>

    <div class="row justify-content-center">

        {% for plot in plots %}
            {% if plot.state.name == 'Libre' or plot.state.name == 'Réservé' %}
                <div class="d-flex align-items-stretch col-12 col-md-6 col-lg-4 mt-1">
                    <div class="card w-100" id="allotmentCardList">
                        <div class="card-header"> Lot n° {{ plot.lot }}</div>
                        <div class="card-body">

                            <h5 class="card-title">Prix Terrain : {{ plot.sellingPriceAti | number_format(0, '', ' ') }}
                                €</h5>

                        </div>
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item">Surface : {{ plot.surface }} m2</li>
                            {% if plot.state.name == 'Libre' %}
                                <li class="list-group-item"><span class="badge badge-pill badge-success">{{ plot.state.name }}</span>  </li>
                            {% else %}
                                <li class="list-group-item"><span class="badge badge-pill badge-warning">{{ plot.state.name }}</span>  </li>
                            {% endif %}

                        </ul>
                        <div class="card-body">
                            <a href="{{ path('all_plot_show', {'id': plot.id}) }}" class="btn btn-secondary">Maisons
                                Compatibles</a>
                        </div>
                    </div>
                </div>
            {% endif %}
        {% endfor %}
    </div>

    <script>
        // Get the modal
        var modal = document.getElementById("myModal");

        // Get the image and insert it inside the modal - use its "alt" text as a caption
        var img = document.getElementById("myImg");
        var modalImg = document.getElementById("img01");
        var captionText = document.getElementById("caption");
        img.onclick = function(){
            modal.style.display = "block";
            modalImg.src = this.src;
            captionText.innerHTML = this.alt;
        }

        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];

        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
            modal.style.display = "none";
        }
    </script>

{% endblock %}



